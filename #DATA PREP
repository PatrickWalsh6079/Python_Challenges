'''
This program grabs all files that start with "BIO" or "SYM" prefix and copies them to folders
labeled "Biofilm" and "Symplast", respectively. It then attaches a randomly assigned 4 letter
prefix to each file so that they are assigned to the folder in random order.
Next, the program moves 400 Biofilm and 400 Symplast files to 8 separate subfolders, each
subfolder containing 100 images of either Biofilm or Symplasts. It also moves 200 files from
the Biofilm and Symplast folders (100 each) into a Testing folder.
Finally, the user has the ability to delete all training data from Biofilm and Symplast folders,
as well as all subfolders and testing folder with a single call.
'''
# ALL BIOFILM
#############################################################
# moves all biofilm images into Biofilm folder with randomly
# attached prefix.
#############################################################

import os, shutil, glob, random, string

# shows where files are coming from
source = r'C:\Users\pwalsh\Desktop\TEMPORARY'
# shows where biofilm images go
dest = r'C:\Users\pwalsh\Desktop\Classifier Testing\Biofilm'
path = os.listdir(source)

# moves all biofilm images to appropriate folder
for f in glob.glob(source+'\\BIO*'):
    shutil.copy(f, dest)

path = r'C:\Users\pwalsh\Desktop\Classifier Testing\Biofilm'

# attaches random prefix to biofilm images
for f in os.listdir(dest):
    os.rename(os.path.join(path,f), os.path.join(path,random.choice(string.ascii_lowercase)
    +random.choice(string.ascii_lowercase)+random.choice(string.ascii_lowercase)+
    random.choice(string.ascii_lowercase)+' '+f))

# ALL SYMPLASTS
#############################################################
# moves all symplast images into Symplast folder with randomly
# attached prefix.
#############################################################

import os, shutil, glob, random, string

# reassigns dest variable to have symplast images go to other folder    
dest = r'C:\Users\pwalsh\Desktop\Classifier Testing\Symplast'

# moves all symplast images to appropriate folder
for f in glob.glob(source+'\\SYM*'):
    shutil.copy(f, dest)

path = r'C:\Users\pwalsh\Desktop\Classifier Testing\Symplast'

# attaches random prefix to symplast images
for f in os.listdir(dest):
    os.rename(os.path.join(path,f), os.path.join(path,random.choice(string.ascii_lowercase)
    +random.choice(string.ascii_lowercase)+random.choice(string.ascii_lowercase)+
    random.choice(string.ascii_lowercase)+' '+f))

# DATASETS 100 EACH
#####################################################################
# moves 800 training images from biofilm and symplasts folders into 
# dataset subfolders of 100 images each. Also moves 200 of biofilm
# and symplast (100 each) into testing folder.
#####################################################################

import os, shutil, glob, random, string

bio = r'C:\Users\pwalsh\Desktop\Classifier Testing\Biofilm'
sym = r'C:\Users\pwalsh\Desktop\Classifier Testing\Symplast'
final_dest = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets'
test = r'C:\Users\pwalsh\Desktop\Classifier Testing\Testing'
counter = 0


# moves biofilm images into respective subfolders
path = os.listdir(bio)


for f in glob.glob(bio+'\\*'):
    shutil.move(f, final_dest+'\\BIO Dataset 1')
    counter += 1
    if counter > 99:
        break

# reset counter to 0
counter = 0

for f in glob.glob(bio+'\\*'):
    shutil.move(f, final_dest+'\\BIO Dataset 2')
    counter += 1
    if counter > 99:
        break

# reset counter to 0
counter = 0

for f in glob.glob(bio+'\\*'):
    shutil.move(f, final_dest+'\\BIO Dataset 3')
    counter += 1
    if counter > 99:
        break

# reset counter to 0
counter = 0
        
for f in glob.glob(bio+'\\*'):
    shutil.move(f, final_dest+'\\BIO Dataset 4')
    counter += 1
    if counter > 99:
        break

# reset counter to 0
counter = 0


# moves symplast images into respective subfolders
path = os.listdir(sym)


for f in glob.glob(sym+'\\*'):
    shutil.move(f, final_dest+'\\SYM Dataset 1')
    counter += 1
    if counter > 99:
        break

# reset counter to 0
counter = 0

for f in glob.glob(sym+'\\*'):
    shutil.move(f, final_dest+'\\SYM Dataset 2')
    counter += 1
    if counter > 99:
        break

# reset counter to 0
counter = 0

for f in glob.glob(sym+'\\*'):
    shutil.move(f, final_dest+'\\SYM Dataset 3')
    counter += 1
    if counter > 99:
        break

# reset counter to 0
counter = 0
        
for f in glob.glob(sym+'\\*'):
    shutil.move(f, final_dest+'\\SYM Dataset 4')
    counter += 1
    if counter > 99:
        break

# reset counter to 0
counter = 0


# moves files into testing folder
path = os.listdir(bio)


for f in glob.glob(bio+'\\*'):
    shutil.move(f, test)
    counter += 1
    if counter > 99:
        break

# reset counter to 0
counter = 0

for f in glob.glob(sym+'\\*'):
    shutil.move(f, test)
    counter += 1
    if counter > 99:
        break

# DATA RESET
#################################################################
# removes all training images from biofilm and symplast folders,
# as well as all subfolders and testing folder.
################################################################

# removes all images from biofilm folder
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Biofilm'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

# removes all images from symplast folder
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Symplast'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

# removes all images from biofilm subfolders
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 1'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 2'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 3'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\BIO Dataset 4'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
        
# removes all images from symplast subfolders
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 1'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 2'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 3'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Datasets\SYM Dataset 4'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)

# removes all images from testing folder
folder = r'C:\Users\pwalsh\Desktop\Classifier Testing\Testing'
for f in os.listdir(folder):
    f = os.path.join(folder, f)
    if os.path.isfile(f):
        os.unlink(f)
